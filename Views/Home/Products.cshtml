@{
    ViewBag.Title = "Products";
}

@*<h2>Products</h2>*@
<div style="padding: 5px; float: left;width: 27%">        
    <table id="tg" class="easyui-treegrid" title="产品列表" style="width:97%;height:800px"
           data-options="
                showHeader:false,
				rownumbers: false,
				collapsible: false,
				fitColumns: true,
				url: '/home/getproducts',
				method: 'get',
				idField: 'ID',
				treeField: 'Cnname',
                onClickRow: ClickRow
			">
        <thead>
            <tr style="height: 40px">
                <th data-options="field:'Cnname',width:150,align:'left'">中文名</th>
            </tr>
        </thead>
    </table>

</div>
<div style="float: right; width: 70%; height: 800px">
    <table width="95%" id="rightTable">
    </table>
</div>

@Styles.Render("~/Content/easyuicssdetail")
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/jeasyuidetail")
<script src="@Url.Content("~/Scripts/jquery-easyui-1.4/jquery.easyui.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-easyui-1.4/jquery.min.js")" type="text/javascript"></script>

<script type="text/javascript" defer="defer">
    var productData; 
    $(function () {
        $.post("/home/GetProducts", {}, function(data, textStatus, jqXhr) {
            productData = data;
            if (typeof data.rows != "undefined") {
                for (var i = 0; i < data.rows.length; i++) {
                    if (data.rows[i].Icon != "") {
                        $("#rightTable").append('<tr><td style="width: 140px"><img src="/UploadFile/' + data.rows[i].Icon + '" /></td><td><a style="font-size: x-large;">' + data.rows[i].Cnname + '</a><br /><br /><br /><br /><br /></td></tr>');
                    }
                }
            }

        });
    });

    function ClickRow(row) {
        if (row.Icon != "") {
            $("#rightTable").html("");
            $("#rightTable").append('<tr><td style="width: 140px"><img src="/UploadFile/' + row.Icon + '" /></td><td><a style="font-size: x-large;">' + row.Cnname + '</a><br /><br /><br /><br /><br /></td></tr>');
        } else {
            $("#rightTable").html("");
            for (var j = 0; j < productData.rows.length; j++) {
                if (productData.rows[j]._parentId == row.ID && productData.rows[j].Icon != "") {                    
                    $("#rightTable").append('<tr><td style="width: 140px"><img src="/UploadFile/' + productData.rows[j].Icon + '" /></td><td><a style="font-size: x-large;">' + productData.rows[j].Cnname + '</a><br /><br /><br /><br /><br /></td></tr>');
                }
            }
        }
    }

    
</script>